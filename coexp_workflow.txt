1 - Infer maximum clade credibility (MCC) tree (BEAST 1.8.4) under a phylogenetic clock model using Yule tree priors from 5,000 post burn-in trees

INPUTS:
Species-level mtDNA fasta alignments (examples included below, all fastas found in '/species_fastas'):
 	Leioheterodon_modestus_mt.fas
 	Leioheterodon_madagascariensis_mt.fas
 	Dromicodryas_bernieri_mt.fas
 	Dromicodryas_quadrilineatus_mt.fas
beastgen.jar
beast.jar
BSP.temp

RUN:
'/1_MCCtree'
BSLP.R

OUTPUTS:
*.log 
*.trees
*.xml 

2 - Use Bayesian implementation of the generalized mixed Yule-coalescent Model to partition the data into population level units from within the assembled species-level mitochondrial datasets
Use 0.5 probability of conspecificity and minimum of 15 samples as a cut-off, for each independent dataset, run MCMC 50,000 generations, discarding the first 40,000 as burn-in and sample every 100 generations
clust.prob = 0.5, min.samp = 10, ntrees = 100, mcmc = 50,000, burnin = 40,000

INPUTS:
idiv. folders/species containing the following
 	*.fas
 	*.trees
bGMYC_1.0.2.tar.gz

RUN
'/2_bGMYC'
GMYC.R

OUTPUTS:
*_1.fas
*_3.fas # *_2.fas removed because <10 samples retained
result.multitree.pdf
heatmap.pdf
result1.pdf


3 - Infer historical population dynamics using the coalescent-based generalized Bayesian skyline plot. Runs were conducted under the HKY model using a random starting tree and a strict molecular clock assuming a mutation rate of 1x10-8. Parameter estimates based on posterior probability distributions constructed by sampling the stationary distribution for 50,000,000 generations every 5,000 steps with the first 25% discarded as burn-in

INPUTS:
Population-level mtDNA fasta alignments from step 2 that retained >10 samples
 	*_1.fas
	*_3.fas
beastgen.jar
beast.jar
BSP.temp

RUN:
'/3_BSLP'
BSLP.R

OUTPUTS:
*.log
*.trees
*.xml


4 - Calculate neutrality statistics Tajima’s D, Ramos-Onsins and Rozas’s R2 - Estimate significance using simulations of 1,000 replicates under an equilibrium model. Calculate diversity statistics H and Pi.

INPUTS:
Population-level mtDNA fasta alignments from step 2:
	x (*_1.fas, *_3.fas as DNAbin objects, use: Pipemaster{fasta2ms, ms.to.DNAbin})
	
RUN:
'/4_exp_stats'
popstats.R


5 - Select between three probable demographic models for each population (constant size, bottleneck, expansion) and obtained median estimates of parameter values of interest with 95% highest posterior density (HPD) intervals for expanding populations

INPUT:
Population-level mtDNA fasta alignments from step 2
 	*_1.fas
 	*_2.fas
	*_3.fas
exp.time.txt
Ne.txt
NeA.txt
gene.txt

RUN:
'/5_singlepop_abc'
single_pop_ABC.R
                                  
OUTPUTS:
*.PDF
*demog_sim.txt
*pop_parameters.txt
*.fas.PDF  # (PCA plot)

6 - Coexpansion hierarchical model simulation

INPUT:
For expanding populations only:
 	observed data: population-level mtDNA fasta alignments from step 2
 	 	*_1.fas
	 	*_3.fas
 	exp.time.txt
 	Ne.txt
 	NeA.txt
 	gene.txt

RUN:
'/6_coexp_sim'

parallel.R # For this paper, parallel(20) was used for all partitions
coexp.R # Alternative time priors: Chan et al. (2014), Narrow Coexpansion Time model (NCT), Partitioned Time model (PT)
parallel_sum.R # For this paper, parallel(20) was used for all partitions

OUTPUTS:
simulations.txt
pop_parameters.txt

7 - Calculate observed hss and approximate parameters of interest 
(zeta, coexp time, avg. exp time, dispersion index)

INPUTS:
For expanding populations only:
 	observed data: Population-level mtDNA fasta alignments from step 2
 	 	*_1.fas
	 	*_3.fas
simulations.txt # From step 6

RUN:
'/7_calc_hss'
coexp_summary.R

OUTPUTS:
NNET.pdf # Plots rejection and Nnet hss
abc_summary.txt # Table of approximations for zeta E(t), ts, and DI

8 - Explore model fit to observed data

INPUTS:
For expanding populations only:
 	observed data: Population-level mtDNA fasta alignments from step 2
 	 	*_1.fas
	 	*_3.fas
simulations.txt

RUN:
'/8_gfit'
gfit_summary.R

OUTPUTS:
pcaGfit.pdf
pcagfitsum.txt


9 - Cross Validation with sim vs. true; cross Validation with 3 zeta bins

INPUTS:
For expanding populations only:
 	observed data: Population-level mtDNA fasta alignments from step 2
 	 	*_1.fas
	 	*_3.fas
simulations.txt

RUN:
'/9_CV'
3zeta_CV.R
CV_parallel.R

10 - Extract elevation data from localities for Malagasy herp populations used in this study; test for correlation in explanatory variables, use Bayesian model selection to distinguish between models predicting neutrality and diversity response variavbles

INPUTS:
mg_species_elevation.csv
mg_species.csv
elevation_summary.csv
real_merge.csv
real_exp_merge.csv

RUN:
'/10_BMA'

extract_alt.R # Summarize elevation information for each species

BMS_tutorial.R # Run BMA: alternative predictor sets: 256 models = '/BMA_arid_humid', 048 models = '/BMA_ecoregion'

OUTPUTS:
*_summary.csv
*_topmodels.csv
*_coef.csv
*_PIPcoef.csv
*_64models.pdf
*_postmodelsizedist.pdf
*_PosteriorModelSizeandProbs.pdf


